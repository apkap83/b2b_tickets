# Run development Environment on port 3500
nx dev b2b_tickets -p 3500

# Creating ui library under libs folder
nx g lib --directory libs --appProject b2b_tickets --tags type:ui,scope:b2b_tickets

# Create config library under libs folder
nx g @nrwl/js:lib config

# Create NavBar component
nx g component NavBar --project ui --export --tags type:ui,scope=b2b_tickets

# Create Footer component
nx g component Footer --project ui --export --tags type:ui,scope=b2b_tickets

# Creating ui-theme library under libs folder
nx g lib --directory libs --tags type:ui,scope:b2b_tickets

# Creating Server Actions library
 nx g @nx/next:library server-actions --directory libs --tags type:server,scope:b2b_tickets

# Creating Assets library (e.g. Nova Logo)
nx g @nx/next:library assets --directory libs --tags type:ui,scope:b2b_tickets

# Creating Utils library
 nx g lib utils --directory libs --tags type:utils,scope:b2b_tickets

# Create React Hooks Library
 nx g @nx/react:library react_hooks --directory libs --tags type:utils,scope:b2b_tickets

 # Create Shared Typescript Models Library
 nx g lib shared-models --directory libs --tags type:utils,scope:shared

 # Create SubmitButton component
nx g component SubmitButton --project ui --export --tags type:ui,scope=b2b_tickets

# Create Admin Dashboard Component under tickets/ui library
nx generate @nx/next:library admin-dashboard --directory=tickets/ui --component

# Create logging library under libs folder
nx g @nrwl/js:lib logging

# Creating Server Actions library
 nx g @nx/next:library admin-server-actions --directory libs --tags type:server,scope:b2b_tickets

# Creating Auth-Options library
 nx g @nx/next:library auth-options --directory libs --tags type:server,scope:b2b_tickets

 # Create Pagination component
nx g component Pagination --project ui --export --tags type:ui,scope=b2b_tickets

 # Logged In Indication component
nx g component LoggedInIndication --project ui --export --tags type:ui,scope=b2b_tickets

# Create Session Popup component
nx g component Pagination --project ui --export --tags type:ui,scope=b2b_tickets

# Sequelize-Auto - Create Models Automatically
    # Generate users model
    npx sequelize-auto -o "./models" -d postgres -h 127.0.0.1 -p 9002 -u postgres -x postgres -s 'b2btickets_dev' --dialect postgres -l tsnpx sequelize-auto -o "./models" -d postgres -h 127.0.0.1 -p 9002 -u postgres -x postgres -s 'b2btickets_dev' --dialect postgres -l ts

    # Generate Whole DB Models
    npx sequelize-auto -o "./models" -d postgres -h 127.0.0.1 -p 9002 -u postgres -x postgres -s 'b2btickets_dev' --dialect postgres -l ts

# Create Comments Component under tickets/ui library
nx generate @nx/next:library comments --directory=tickets/ui --component

# Create E-mail service Library
nx g lib email-service --directory libs --tags type:utils,scope:shared

# Create TOTP service Library
nx g lib totp-service --directory libs --tags type:utils,scope:shared

# Create NavBar component
nx g component EscalationBars --project ui --export --tags type:ui,scope=b2b_tickets

# Create Socket Server Application
nx generate @nx/node:application Socket_Server --verbose

nx report
nx show project socket-server

# Run in Development Mode
export DEBUG=1
export NODE_ENV=development
export PORT=3455
export SOCKET_CORS_ORIGIN=http://127.0.0.1:3000
export NEXT_AUTH_SESSION_URL=http://127.0.0.1:3000/api/auth/session
export NODE_TLS_REJECT_UNAUTHORIZED=0
nx serve socket-server 

# Run in Staging Mode
export DEBUG=1
export NODE_ENV=staging
export PORT=3456
export SOCKET_CORS_ORIGIN=https://10.124.49.151:8444
export NEXT_AUTH_SESSION_URL=https://10.124.49.151:8444/api/auth/session
export NODE_TLS_REJECT_UNAUTHORIZED=0
nx build socket-server --configuration=staging --verbose
node dist/apps/socket-server/main.js

# Run in Production Mode
export DEBUG=1
export NODE_ENV=staging
export PORT=3457
export SOCKET_CORS_ORIGIN=https://10.124.49.151
export NEXT_AUTH_SESSION_URL=https://10.124.49.151/api/auth/session
export NODE_TLS_REJECT_UNAUTHORIZED=0
nx build socket-server --configuration=production --verbose
node dist/apps/socket-server/main.js


# Altered Postgres configuration
show statement_timeout;
show idle_in_transaction_session_timeout;

ALTER SYSTEM SET statement_timeout = '40000'; -- 40 seconds
SET statement_timeout = '40000'; -- 40 seconds

ALTER SYSTEM SET idle_in_transaction_session_timeout = '60000'; -- 1 minute

SELECT pg_reload_conf();


# Add Jest to a project
nx g @nx/jest:configuration --project=tickets

# Test E2E 
cd apps/b2b_tickets-e2e; 
npx playwright test --project chromium

# OR using nx
nx run b2b_tickets-e2e:e2e  